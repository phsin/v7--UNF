# Выгрузка документов 1С Предприятие 7.7 в 1С:УНФ

Обработка для 1С Предприятие 7.7 работает совместно с [расширением для 1С:УНФ](http://xn----ctbjbnchgq5bbglv.xn--p1ai/crpt)

# Установка 

Скопируйте 1cpp.dll и formex.dll в каталог конфигурации
В Глобальный модуль конфигурации в процедуру ПриНачалеРаботыСистемы() добавьте строки загрузки dll:

```
Процедура ПриНачалеРаботыСистемы()

	Попытка
		имяф=КаталогИБ()+"1cpp.dll";
		ЗагрузитьВнешнююКомпоненту(имяф);
		Сообщить("Загружена "+имяф);
	Исключение
		Сообщить("Ошибка при загрузке внешней компоненты: "+имяф);
		Сообщить("Некоторые функции будут недоступны");
	КонецПопытки;
	Попытка
		имяф=КаталогИБ()+"formex.dll";
		ЗагрузитьВнешнююКомпоненту(имяф);

		Сообщить("Загружена "+имяф);
		Сервис = СоздатьОбъект("Сервис");
		Сервис.ВключитьРаскраскуТаблиц();
	Исключение
		Сообщить("Ошибка при загрузке внешней компоненты: "+имяф);
		Сообщить("Некоторые функции будут недоступны");
	КонецПопытки;

 КонецПроцедуры //ПриНачалеРаботыСистемы()
```

В документ Реализация добавьте кнопку с вызовом функции
```
Процедура Отправить_в_УНФ()

	ГМ = СоздатьОбъект("кб99_ГлобальныйМодуль");
	ГМ.ОтправитьВ_УНФ( ТекущийДокумент() );	
	
КонецПроцедуры

```



[Подробное описание выгрузки](https://kb99.pro/crpt)
